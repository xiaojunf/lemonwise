olark.declare({name:"WelcomeAssist",version:"1.0",startup:function(b,g){function o(){function p(a){a=a.replace(/https?\:\/\//g,"");a=["^",a.replace(/\./g,"\\.").replace(/\*/g,".*"),"$"];return RegExp(a.join(""))}var b=window.location.href.replace(/https?\:\/\//g,""),a;for(a in e){var c=e[a],d=c&&!/^\s*$/.test(c)?!0:!1;if(e.hasOwnProperty(a)&&d&&p(c).test(b))return!0}return!1}function h(){o()&&b.chat.operatorsAreAvailable()&&f.get()!==!0&&(f.set(!0),i&&(b.box.expand(),j=!0,b.box.__SPI_setPrechatWelcomeMessage(k)),
l&&b.chat.sendNotificationToOperator({body:"this is a new visitor, you might want to welcome him or her"}))}var c=g.WelcomeAssist,a=g.Greeter||{},i=c.welcome_new_visitors||a.welcome_new_visitors?!0:!1,q=c.welcome_delay_in_seconds||a.welcome_delay_in_seconds||5,l=c.notify_operator_of_new_visitors||a.notify_operator_of_new_visitors?!0:!1,d=c.welcome_messages||a.welcome_messages||["hi, can I help you?"],e;e=a.urls?a.urls&&a.urls.length>0?a.urls:["*"]:c.urls&&c.urls.length>0?c.urls:["*"];var f=b.data.getVisitorObject({key:"did_initiate_ever",
initialValue:!1,backup:"wa1",backupTransform:function(a){return a=="true"?!0:!1}}),j=!1,k=function(){var a,b=Math.floor(Math.random()*d.length);a=d[b];for(b=d.length;b&&(typeof a=="undefined"||a==null||/^\s*$/.test(a));)b--,a=d[b];return a||"hi, can I help you?"}();b.chat.onBeginConversation(function(){j&&b.chat.sendNotificationToOperator({body:"in reply to welcome message '"+k+"'"});f.set(!0)});var m=!1,n=!1;(i||l)&&setTimeout(function(){m?h():n=!0;b.chat.connect()},q*1E3);b.chat.onReady(function(){m=
!0;n&&h()})}});
